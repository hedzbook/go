<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEDZ Forex Trilogy</title>
    <style>
      /* =====================
         Base Styles
      ===================== */
      html, body { height: 100%; }
      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        font-family: 'Segoe UI', Arial, sans-serif;
        background: #F9F8F4;
        margin: 0;
        color: #222;
      }
      main { flex: 1; }
      .intro {
        text-align: justify;
        width: 100%;
        padding-bottom: 2rem;
        font-size: 1.1rem;
      }
      h1 {
        text-align: center;
        margin-bottom: 2rem;
        font-size: 2.5rem;
        letter-spacing: 2px;
      }
      /* =====================
         Header & Navigation
      ===================== */
      header {
        background: #fff;
        color: #222;
        padding: 0.25rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 6px 24px rgba(0,0,0,0.22);
        position: sticky;
        top: 0;
        z-index: 1101;
      }
      .logo { margin-left: -1rem; }
      .logo img {
        height: 50px;
        vertical-align: middle;
      }
      nav {
        display: flex;
        align-items: center;
      }
      nav a {
        color: #222;
        text-decoration: none;
        margin-left: 2rem;
        font-size: 1rem;
        font-weight: bold;
        transition: color 0.2s;
      }
      nav a:hover { color: #ffd700; }
      .menu-toggle, .menu-close { display: none; }
      /* =====================
         Books Grid & Cards
      ===================== */
      main {
        max-width: 1200px;
        margin: 5rem auto -1.7rem; /* top | sides | bottom */
        padding: 0 1rem;
      }
      .books-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(325px, 1fr));
        gap: 2rem;
      }
      .book-container {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 6px 24px rgba(0,0,0,0.22);
        padding: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: box-shadow 0.2s;
      }
      .book-container:hover {
        box-shadow: 0 12px 36px rgba(0,0,0,0.28);
      }
      .book-image img {
        width: 180px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.10);
        transition: transform 0.2s;
        cursor: pointer;
      }
      .book-image img:hover { transform: scale(1.05); }
      .book-title {
        font-weight: bold;
        text-align: center;
        font-size: 1.15rem;
        white-space: nowrap;
      }
      .book-subtitle {
        font-weight: bold;
        text-align: center;
        margin-bottom: 0.5rem;
      }
      .book-desc { text-align: justify; }
      /* =====================
         Book Prices & Buttons
      ===================== */
      .book-prices {
        font-size: 1.05rem;
        line-height: 1.5;
      }
      .book-format {
        font-weight: 600;
        letter-spacing: 0.5px;
      }
      .book-price {
        font-weight: bold;
        color: #222;
      }
      .buy-now-button {
        display: inline-block;
        background: #ffd700;
        color: #222;
        font-size: 1.0rem !important;
        padding: 0.5rem 1rem !important;
        border-radius: 6px;
        font-weight: bold;
        text-decoration: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.07);
        transition: background 0.2s;
        margin-bottom: 0.5rem;
        margin-top: 0;
      }
      .buy-now-button:hover, .learn-more-button:hover { background: #ffb700; }
      .learn-more-button {
        display: inline-block;
        background: none;
        color: #222;
        font-size: 0.8rem !important;
        padding: 0.5rem 1rem !important;
        border-radius: 6px;
        font-weight: bold;
        text-decoration: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.07);
        transition: background 0.2s;
        margin-bottom: 0.5rem;
        margin-top: 0;
      }
      /* =====================
         Footer
      ===================== */
      footer {
        background: #F9F8F4;
        color: #222;
        text-align: center;
        padding: 1rem 0;
        margin-top: 3rem;
        box-shadow: 0 6px 24px rgba(0,0,0,0.22);
      }
      /* =====================
         Lightbox Styles
      ===================== */
      .lightbox {
        display: none;
        position: fixed;
        z-index: 3000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        justify-content: center;
        align-items: center;
      }
      .lightbox-content {
        position: relative;
        max-width: 90%;
        max-height: 90%;
      }
      .lightbox-content img {
        max-width: 100%;
        max-height: 100%;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      }
      .lightbox button {
        background: none;
        border: none;
        cursor: pointer;
        position: absolute;
        color: #fff;
        font-weight: bold;
        user-select: none;
      }
      .lightbox .close {
        top: 20px;
        right: 30px;
        font-size: 2.5rem;
        z-index: 3100;
      }
      .lightbox .prev,
      .lightbox .next {
        top: 50%;
        transform: translateY(-50%);
        font-size: 3rem;
        padding: 0 15px;
        z-index: 3100;
      }
      .lightbox .prev { left: 7px; }
      .lightbox .next { right: 10px; }
      .lightbox button:hover { color: #ffd700; }
      /* =====================
         Responsive Styles (Mobile)
         All @media (max-width: 700px) in one block
      ===================== */
      @media (max-width: 700px) {
        /* Header & Navigation */
        header {
          height: 40px;
          padding: 0.25rem 2rem;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          z-index: 1000;
          transform: translateY(0);
          transition: none; /* no delay â€” direct control by JS */
          will-change: transform;
        }
        header.hide { transform: translateY(-100%); }
        .logo img {
          height: 40px;
          vertical-align: middle;
        }
        header.menu-fixed {
    position: fixed !important;
    top: 0;
    left: 0;
    right: 0;
    transform: translateY(0) !important;
  }
        .menu-toggle {
          display: block;
          background: none;
          margin-right: -1.5rem;
          border: none;
          font-size: 2.5rem;
          color: #222;
          cursor: pointer;
          z-index: 1100;
        }
        .menu-close {
          display: none;
          position: absolute;
          right: 0.7rem;
          top: 0.7rem;
          background: #fff;
          border: 2px solid #222;
          color: #222;
          border-radius: 50%;
          width: 32px;
          height: 32px;
          font-size: 1rem;
          cursor: pointer;
          line-height: 28px;
          z-index: 1100;
        }
        nav {
          flex-direction: column;
          align-items: flex-start;
          position: fixed;
          top: 48px;
          left: 1px;
          width: 100vw;
          height: calc(100vh - 48px);
          background: #fff;
          box-shadow: 0 6px 24px rgba(0,0,0,0.22);
          padding: 2.5rem;
          display: none;
          overflow-y: auto;
          -webkit-overflow-scrolling: touch;
          z-index: 1000;
        }
        nav a {
          text-align: left;
          margin: 1.2rem 0;
          font-size: 1.1rem !important;
        }
        nav.active { display: flex; }
        /* Main & Books Grid */
        main {
          margin-left: -2px !important;
        }
        main h1 {
          font-size: 1.1rem !important;
        }
        main .intro {
          font-size: 0.88rem !important;
        }
        main .book-title {
          font-size: 0.9rem !important;
        }
        main .book-subtitle {
          font-size: 0.8rem !important;
        }
        main .book-desc {
          font-size: 0.71rem !important;
        }
        main .buy-now-button {
          font-size: 0.7rem !important;
          padding: 0.5rem 1rem !important;
        }
        main .learn-more-button {
          font-size: 0.54rem !important;
          padding: 0.5rem 1rem !important;
        }
        main .books-grid {
          gap: 1.2rem !important;
        }
        /* Book Prices */
        .book-prices {
          font-size: 0.7rem !important;
          line-height: 1.7;
        }
        .book-format {
          font-weight: 250 !important;
          letter-spacing: 0.5px;
        }
        .book-price {
          font-weight: bold !important;
          color: #222 !important;
        }
        /* Footer */
        footer {
          font-size: 0.7rem;
        }
        /* Lightbox Mobile Tweaks */
        .lightbox .prev,
        .lightbox .next {
          font-size: 2.2rem;
          padding: 0 8px;
          z-index: 3100;
        }
        .lightbox .prev { left: 15px; }
        .lightbox .next { right: 15px; }
        .lightbox .close {
          font-size: 2rem;
          top: 10px;
          right: 15px;
          z-index: 3101;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <a href="../" class="logo">
        <img src="../images/HEDZ%20BOOK%20LOGO.png" alt="HEDZ Logo">
      </a>
      <button class="menu-toggle" id="menuToggle" aria-label="Open menu">&#9776;</button>
      <button class="menu-close" id="menuClose" aria-label="Close menu">&#10005;</button>
      <nav id="mainNav">
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
        <a href="../">Home</a>
        <a href="./">Forex Trilogy</a>
        <a href="../classics">Forex Classics</a>
        <a href="../ZLCHS">ZLCHS Access</a>
        <a href="../about">About Author</a>
      </nav>
    </header>
    <main>
      <h1>HEDZ Forex Trilogy</h1>
      <p class="intro">
        HEDZ Forex Trilogy is a comprehensive three-part collection that explores the Mastery of Forex Trading through Foundations, Psychology, and Strategy. Together, the volumes provide a clear path from thoroughly understanding the marketâ€™s structure, to strengthening the discipline of the mind, to applying risk-controlled strategies for sustainable growth. Each book focuses on one pillar while connecting seamlessly to the next, creating a complete journey. The trilogy reflects HEDZâ€™s commitment to clarity, depth, and lasting insight for readers seeking knowledge, discipline, and resilience in forex trading.
      </p>
      <div class="books-grid">
        <!-- Book 1 -->
        <div class="book-container">
          <div class="book-image">
            <img src="../images/foundation-front.jpg" alt="Foundation Front Cover" class="popup-img" data-img="../images/foundation-front.jpg" data-group="foundation" loading="lazy">
            <img src="../images/foundation-back.jpg" alt="Foundation Back Cover" class="popup-img" data-img="../images/foundation-back.jpg" data-group="foundation" style="display:none;" loading="lazy">
          </div>
          <div class="book-info">
            <h2 class="book-title">The Foundation of Forex Trading</h2>
            <div class="book-subtitle">Timeless Lessons on Markets,<br>Money, and Methodology</div>
            <p class="book-desc"><em>What if "The Mastery of Forex Trading" begins with understanding the foundational structures of the market?</em> <strong>Foundation</strong> marks the stage where traders gain insight into the marketâ€™s framework. Insight into how currency pairs interrelate, how liquidity drives these relationships, and how intermarket correlations influence price movements is essential. Knowledge of brokers, platforms, swaps, and hidden costs forms a reliable base. Mastering capital management, leverage, and risk ensures a sustainable trading approach. Developing technical skills, from candlesticks to multi-timeframe analysis, supports identifying trends and patterns. Awareness of economic indicators and geopolitical events shaping currency valuations sharpens decision-making. Armed with a professional blueprint emphasizing disciplined routines, trade selection, journaling, and financial integration, traders build the foundation required to achieve success in Retail Forex Trading.</p>
            <div style="display:flex; justify-content:space-between; align-items:center; width:100%; margin-bottom:0.5rem;">
              <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <a href="#" class="learn-more-button">Learn More</a>
                <a href="#" class="buy-now-button" data-asin="B0FMFN9X4R">Buy Now</a>
              </div>
              <div class="book-prices" style="text-align:right; margin-left:2rem;">
                <span class="book-format">Kindle</span> &nbsp;&nbsp;<span class="book-price">$9.99</span><br>
                <span class="book-format">Paperback</span> <span class="book-price">$23.33</span><br>
                <span class="book-format">Hardcover</span> <span class="book-price">$33.33</span>
              </div>
            </div>
          </div>
        </div>
        <!-- Book 2 -->
        <div class="book-container">
          <div class="book-image">
            <img src="../images/psychology-front.jpg" alt="Psychology Front Cover" class="popup-img" data-img="../images/psychology-front.jpg" data-group="psychology" loading="lazy">
            <img src="../images/psychology-back.jpg" alt="Psychology Back Cover" class="popup-img" data-img="../images/psychology-back.jpg" data-group="psychology" style="display:none;" loading="lazy">
          </div>
          <div class="book-info">
            <h2 class="book-title">The Psychology of Forex Trading</h2>
            <div class="book-subtitle">Timeless Lessons on Biases,<br>Behaviour, and Breakthroughs</div>
            <p class="book-desc"><em>What if "The Mastery of Forex Trading" truly depends on mastering the mind as much as the market itself?</em> <strong>Psychology</strong> marks the stage where trading foundations give way to the mind that governs every decision. Stress responses and primal instincts influence judgement, while biases such as overconfidence, illusion of control, and loss aversion distort risk perception. Emotional triggers and discipline gaps cause repeated trading failures unless countered with proven mental tools like mindfulness, journaling, cognitive reframing, and resilience practices. Transformation grows through rest, recovery, micro-progress, mentorship, and true community support, turning setbacks into psychological strength. Over time, psychology and discipline integrate into identity, creating a resilient long-game mindset. This mental evolution becomes the bridge to strategy, where risk control, survival, and compounding profits truly define success in Retail Forex Trading.</p>
            <div style="display:flex; justify-content:space-between; align-items:center; width:100%; margin-bottom:0.5rem;">
              <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <a href="#" class="learn-more-button">Learn More</a>
                <a href="#" class="buy-now-button" data-asin="B0FMFN9X4R">Buy Now</a>
              </div>
              <div class="book-prices" style="text-align:right; margin-left:2rem;">
                <span class="book-format">Kindle</span> &nbsp;&nbsp;<span class="book-price">$9.99</span><br>
                <span class="book-format">Paperback</span> <span class="book-price">$23.33</span><br>
                <span class="book-format">Hardcover</span> <span class="book-price">$33.33</span>
              </div>
            </div>
          </div>
        </div>
        <!-- Book 3 -->
        <div class="book-container">
          <div class="book-image">
            <img src="../images/strategy-front.jpg" alt="Strategy Front Cover" class="popup-img" data-img="../images/strategy-front.jpg" data-group="strategy" loading="lazy">
            <img src="../images/strategy-back.jpg" alt="Strategy Back Cover" class="popup-img" data-img="../images/strategy-back.jpg" data-group="strategy" style="display:none;" loading="lazy">
          </div>
          <div class="book-info">
            <h2 class="book-title">The Strategy of Forex Trading</h2>
            <div class="book-subtitle">Timeless Lessons on ZeroLoss,<br>Compounded Hedging System</div>
            <p class="book-desc"><em>What if "The Mastery of Forex Trading" rests on a strategy built to control risk, survive, and compound profits?</em> <strong>Strategy</strong> marks the stage where strong foundations and psychology converge into execution. The ZeroLoss Compounded Hedging System (CHS) provides a systematic framework that unites capital protection with steady, long-term growth. Hedging protects capital, while structured compounding turns small gains into cumulative returns. All positions are dynamically managed to control risk and secure profits. System design includes coding an MT5 Expert Advisor with supporting indicators, backtesting, optimization, and automation for reliable execution. Testing in trending, ranging, and volatile markets shows resilience and adaptability. As traders apply and refine CHS on VPS hosting, it evolves with them, cultivating consistency and control. Over time, strategy and identity merge, enabling risk-controlled growth and success in Retail Forex Trading.</p>
            <div style="display:flex; justify-content:space-between; align-items:center; width:100%; margin-bottom:0.5rem;">
              <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <a href="#" class="learn-more-button">Learn More</a>
                <a href="#" class="buy-now-button" data-asin="B0FMFN9X4R">Buy Now</a>
              </div>
              <div class="book-prices" style="text-align:right; margin-left:2rem;">
                <span class="book-format">Kindle</span> &nbsp;&nbsp;<span class="book-price">$9.99</span><br>
                <span class="book-format">Paperback</span> <span class="book-price">$23.33</span><br>
                <span class="book-format">Hardcover</span> <span class="book-price">$33.33</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer>
      &copy; 2025 HEDZ BOOK. All rights reserved.
    </footer>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox">
      <button class="prev" aria-label="Previous" onclick="changeImage(-1)">&#10094;</button>
      <div class="lightbox-content">
        <img id="lightbox-img" src="" alt="Book Cover">
      </div>
      <button class="next" aria-label="Next" onclick="changeImage(1)">&#10095;</button>
    </div>

    <script>
// nav toggle
const menuToggle = document.getElementById('menuToggle');
const menuClose = document.getElementById('menuClose');
const nav = document.getElementById('mainNav');
const header = document.querySelector("header");

menuToggle.onclick = () => {
  nav.classList.add('active');
  menuToggle.style.display = 'none';
  menuClose.style.display = 'block';
  
  // Lock body scroll
  document.body.style.overflow = 'hidden';
  header.classList.add('menu-fixed'); // ensure header stays fixed
};

menuClose.onclick = () => {
  nav.classList.remove('active');
  menuClose.style.display = 'none';
  menuToggle.style.display = 'block';
  
  // Restore body scroll
  document.body.style.overflow = '';
  header.classList.remove('menu-fixed');
};

// --- Scroll-hide header (only when not fixed) ---
let lastScrollY = window.scrollY;

window.addEventListener("scroll", () => {
  if (header.classList.contains("menu-fixed")) return; // skip when menu is open

  const currentScrollY = window.scrollY;
  const diff = currentScrollY - lastScrollY;

  let offset = Math.min(
    0,
    Math.max(-header.offsetHeight, parseFloat(header.dataset.offset || 0) - diff)
  );

  header.style.transform = `translateY(${offset}px)`;
  header.dataset.offset = offset;
  lastScrollY = currentScrollY;
});

      // Buy Now button country-aware redirect (simplified)
      function getAmazonUrl(countryCode, asin) {
        // Map country code to Amazon marketplace domain
        let domain = 'com';
        switch (countryCode) {
          case 'UK': domain = 'co.uk'; break;      // United Kingdom
          case 'DE': domain = 'de'; break;         // Germany
          case 'FR': domain = 'fr'; break;         // France
          case 'ES': domain = 'es'; break;         // Spain
          case 'IT': domain = 'it'; break;         // Italy
          case 'NL': domain = 'nl'; break;         // Netherlands
          case 'JP': domain = 'co.jp'; break;      // Japan
          case 'CA': domain = 'ca'; break;         // Canada
          case 'BR': domain = 'com.br'; break;     // Brazil
          case 'MX': domain = 'com.mx'; break;     // Mexico
          case 'AU': domain = 'com.au'; break;     // Australia
          case 'IN': domain = 'in'; break;         // India
          case 'TR': domain = 'com.tr'; break;     // Turkey
          case 'SG': domain = 'sg'; break;         // Singapore
          case 'AE': domain = 'ae'; break;         // United Arab Emirates
          case 'SA': domain = 'sa'; break;         // Saudi Arabia
          case 'SE': domain = 'se'; break;         // Sweden
          case 'PL': domain = 'pl'; break;         // Poland
        }
        return `https://www.amazon.${domain}/dp/${asin}`;
      }
      document.querySelectorAll('.buy-now-button').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const asin = btn.getAttribute('data-asin');
          fetch('https://ipapi.co/country/')
            .then(resp => resp.text())
            .then(countryCode => {
              countryCode = countryCode.trim();
              const url = getAmazonUrl(countryCode, asin);
              window.open(url, '_blank');
            })
            .catch(() => {
              // fallback to US
              window.open(getAmazonUrl('US', asin), '_blank');
            });
        });
      });

      // Lightbox
      const lightbox = document.getElementById("lightbox");
      const lightboxImg = document.getElementById("lightbox-img");
      let currentGroup = [];
      let currentIndex = 0;

      document.querySelectorAll(".popup-img").forEach(img => {
        img.addEventListener("click", function() {
          const groupName = this.dataset.group;
          currentGroup = Array.from(document.querySelectorAll(`.popup-img[data-group="${groupName}"]`));
          currentIndex = currentGroup.findIndex(i => i.dataset.img === this.dataset.img);
          openLightbox(currentGroup[currentIndex].dataset.img);
        });
      });

      // --- Pan/drag variables ---
      let isDragging = false;
      let dragStartX = 0;
      let dragStartY = 0;
      let imgOffsetX = 0;
      let imgOffsetY = 0;

      function openLightbox(src) {
        lightbox.style.display = "flex";
        lightboxImg.src = src;
        resetZoom();
      }
      function closeLightbox() {
        lightbox.style.display = "none";
        resetZoom();
      }
      function changeImage(step) {
        if (!currentGroup.length) return;
        currentIndex = (currentIndex + step + currentGroup.length) % currentGroup.length;
        lightboxImg.src = currentGroup[currentIndex].dataset.img;
        resetZoom();
      }

      // --- Desktop click-and-drag panning ---
      lightboxImg.addEventListener('mousedown', function(e) {
        if (zoom > 1) {
          isDragging = true;
          dragStartX = e.clientX;
          dragStartY = e.clientY;
          lightboxImg.style.cursor = 'grab';
        }
      });
      window.addEventListener('mousemove', function(e) {
        if (isDragging && zoom > 1) {
          imgOffsetX += (e.clientX - dragStartX);
          imgOffsetY += (e.clientY - dragStartY);
          dragStartX = e.clientX;
          dragStartY = e.clientY;
          updateTransform();
        }
      });
      window.addEventListener('mouseup', function() {
        if (isDragging) {
          isDragging = false;
          lightboxImg.style.cursor = '';
        }
      });

      // --- Mobile touch-drag panning ---
      lightboxImg.addEventListener('touchstart', function(e) {
        if (zoom > 1 && e.touches.length === 1) {
          isDragging = true;
          dragStartX = e.touches[0].clientX;
          dragStartY = e.touches[0].clientY;
        }
      });
      lightboxImg.addEventListener('touchmove', function(e) {
        if (isDragging && zoom > 1 && e.touches.length === 1) {
          imgOffsetX += (e.touches[0].clientX - dragStartX);
          imgOffsetY += (e.touches[0].clientY - dragStartY);
          dragStartX = e.touches[0].clientX;
          dragStartY = e.touches[0].clientY;
          updateTransform();
        }
      });
      lightboxImg.addEventListener('touchend', function(e) {
        isDragging = false;
      });

      function updateTransform() {
        lightboxImg.style.transform = `scale(${zoom}) translate(${imgOffsetX/zoom}px, ${imgOffsetY/zoom}px)`;
        lightboxImg.style.transformOrigin = `${originX}% ${originY}%`;
      }

      // --- Close on tap/click on overlay only ---
      lightbox.addEventListener('click', function(e) {
        // Only close if click/tap is on overlay, not image or controls
        if (e.target === lightbox) closeLightbox();
      });
      // Prevent image click/tap from closing
      lightboxImg.addEventListener('click', function(e) {
        e.stopPropagation();
      });
      lightboxImg.addEventListener('touchend', function(e) {
        e.stopPropagation();
      });

      window.addEventListener("keydown", e => {
        if (e.key === "Escape") closeLightbox();
        if (e.key === "ArrowRight") changeImage(1);
        if (e.key === "ArrowLeft") changeImage(-1);
      });

      // --- Swipe gesture for mobile ---
      let touchStartX = 0;
      let touchEndX = 0;
      lightboxImg.addEventListener('touchstart', function(e) {
        if (e.touches.length === 1) {
          touchStartX = e.touches[0].clientX;
        }
      });
      lightboxImg.addEventListener('touchend', function(e) {
        if (e.changedTouches.length === 1) {
          touchEndX = e.changedTouches[0].clientX;
          const deltaX = touchEndX - touchStartX;
          if (Math.abs(deltaX) > 50) {
            if (deltaX > 0) {
              changeImage(-1); // swipe right
            } else {
              changeImage(1); // swipe left
            }
          }
        }
      });

      // --- Mouse wheel zoom (desktop) ---
      let zoom = 1;
      let originX = 0;
      let originY = 0;
      function resetZoom() {
        zoom = 1;
        originX = 0;
        originY = 0;
        imgOffsetX = 0;
        imgOffsetY = 0;
        lightboxImg.style.transform = '';
        lightboxImg.style.transformOrigin = '';
      }
      lightboxImg.addEventListener('wheel', function(e) {
        e.preventDefault();
        // Only zoom if lightbox is open
        if (lightbox.style.display !== 'flex') return;
        // Calculate mouse position relative to image
        const rect = lightboxImg.getBoundingClientRect();
        originX = ((e.clientX - rect.left) / rect.width) * 100;
        originY = ((e.clientY - rect.top) / rect.height) * 100;
        // Zoom in/out
        if (e.deltaY < 0) {
          zoom = Math.min(zoom + 0.15, 3);
        } else {
          zoom = Math.max(zoom - 0.15, 0.5);
          // If zoomed out below threshold, close lightbox
          if (zoom < 0.65) closeLightbox();
        }
        updateTransform();
      }, { passive: false });

    </script>
  </body>
</html>
